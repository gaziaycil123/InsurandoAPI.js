
function InsurandoAPI(r,t,n){if(!r)throw"base url can not be null";if(!t)throw"user name can not be null";if(!n)throw"password can not be null";function i(e,t){var n=new XMLHttpRequest;return t=r+t,n.open(e,t,!0),n.setRequestHeader("Content-Type","application/json"),a&&n.setRequestHeader("Authorization","Bearer "+a.Token),n}function e(){var e=i("Post","authentication/login");e.onreadystatechange=function(){4==this.readyState&&200==this.status&&(a=JSON.parse(this.responseText))},e.send(JSON.stringify({UserName:t,Password:n}))}var a=null;this.Company={Health:function(t){if(!t)throw"delegate function required";(!a||a.Expiration<=new Date)&&(a=null,e());var n=setInterval(function(){if(a){clearInterval(n);var e=i("GET","company/health");e.onreadystatechange=function(){t(this)},e.send()}},500)}},this.PostCode=function(){return 1==arguments.length?function(t){if(!t)throw"delegate function required";(!a||a.Expiration<=new Date)&&(a=null,e());var n=setInterval(function(){if(a){clearInterval(n);var e=i("GET","postcode");e.onreadystatechange=function(){t(this)},e.send()}},500)}(arguments[0]):2==arguments.length?function(t,n){if(!n)throw"delegate function required";if("number"!=typeof t)throw"post code must be number";if(4<String(t).length)throw"invalid post code search term";(!a||a.Expiration<=new Date)&&(a=null,e());var r=setInterval(function(){if(a){clearInterval(r);var e=i("GET","postcode/"+t);e.onreadystatechange=function(){n(this)},e.send()}},500)}(arguments[0],arguments[1]):void 0},this.Region=function(t,n){if(!t)throw"post code required";if(!n)throw"delegate function required";if("number"!=typeof t)throw"post code must be number";if(4!==String(t).length)throw"invalid post code";(!a||a.Expiration<=new Date)&&(a=null,e());var r=setInterval(function(){if(a){clearInterval(r);var e=i("GET","region/"+t);e.onreadystatechange=function(){n(this)},e.send()}},500)},this.Lead=function(t,n){if(!t)throw"lead object required";if(!n)throw"delegate function required";(!a||a.Expiration<=new Date)&&(a=null,e());var r=setInterval(function(){if(a){clearInterval(r);var e=i("POST","lead");e.onreadystatechange=function(){n(this)},e.send(JSON.stringify(t))}},500)}}
